- Drug combinations are of great interest for cancer treatment. 

-  Here we investigate to which extent drug combination synergy can be predicted by exploiting the
largest available dataset to date (NCI-ALMANAC, with over 290,000 synergy determinations).

- Each cell line is modeled using primarily two machine learning techniques, Random Forest (RF) and Extreme Gradient Boosting (XGBoost),
 on the datasets provided by NCI-ALMANAC.

- However, the question remains of how well ComboScores can be predicted on each NCI-60 cell line, which is important 
given that ComboScore-based screening has led to the identification of novel synergistic drug combinations

- The evaluation of these models shows that it is possible to predict the synergy of unseen drug combinations with high accuracy 
(Pearson correlations between 0.43 and 0.86 depending on the considered cell line, with XGBoost providing slightly better predictions than RF)

- One major roadblock in drug synergy modeling has been the lack of homogeneous data 
(i.e., datasets generated with the same assay, experimental conditions and synergy quantification).

-  large datasets from High-Throughput Screening (HTS) of drug combinations on cancer cell lines

- Quantitative Structure-Activity Relationship (QSAR) models establish a mathematical relationship between the chemical structure of a molecule, 
encoded as a set of structural and/or physico-chemical features (descriptors), and its biological activity on a target

- Methods:
Data used:
NCI - ALMANAC is the largest-to-date phenotypic drug combination HTS.
It contains the synergy measurements of pairwise combinations of 104 FDA approved drugs on the 60 cancer cell lines 

Features used:
1. Morgan Fingerprints describing the connectivity of the molecular structure
2. Morgan FingerPrint Counts (MFPC) are a non-binary version of MFP that takes integer 
values equal to the number of times the pattern is detected in the molecule
3. MACCS keys: encode presence or absence of 166 predetermined substructural fragments as binary vectors (calculated with RDKit).
4. ISIDA fragments 
5. SIRMS fragments

They have been calculated with RDKit library (Lamdrum, 2015) using the following parametersâ€”length is 256 bits, radius is 2.
 (2) Morgan FingerPrint Counts (MFPC) are a non-binary values that takes integer values equal to the number of times the 
 pattern is detected in the molecule (256 features per drug, also calculated with RDKit).

(3) MACCS keys encode presence or absence
of 166 predetermined substructural fragments as binary vectors (calculated with RDKit). 

(4) ISIDA fragments encode structure as a 
vector of numbers of occurrences of substructural fragments in a molecule. 
Only one type of fragments is considered here: sequences of atoms
and bonds of length 2 to 6 (1,325 features per drug in total). 

(5) SIRMS fragments are the number of occurrences of 4-atom fragments 
of varying topology in a molecule, including bonded and non-bonded atoms it led to 1,454 features per drug. 



Methods to predict synergy scores:
1. labor and cost-intensive. Furthermore, it might expose patients to
unnecessary or even harmful treatment.

2. Another strategy to identify synergistic drug pairs without
harming patients is high-throughput screening (HTS). 
A large number of measurements can be produced in reasonable time at low
costs. 
In these screens different concentrations of two
drugs are applied to a cancer cell line. But their ability to accurately
represent the in vivo state is often questioned. The reason is that
even if there is a high genomic correlation between the original
tumour and the derived cancer cell line, it is still far from perfect.

3. Computational methods such as machine learning models offer
the possibility to efficiently explore the large synergistic space.
Accurate predictive models can be generated by leveraging the available synergy data.
Due to the fast development of high-throughput methods, the
amount of available synergy data points has tremendously increased.




In one of the papers 
Discussion:
- They have found that it is possible to predict the synergy of unseen drug combinations against NCI-60 panel 
cell lines with high accuracy by exploiting NCI-ALMANAC data.

QSAR: Quantitative Structure-Activity Relationship (QSAR) models establish a mathematical relationship between the chemical structure
of a molecule, encoded as a set of structural and/or physico-chemical features (descriptors), and its biological activity on a target


- Recent QSAR and drug combination modeling studies have evaluated the application of the latest machine learning algorithms
(e.g., XGBoost, Deep Neural Network). These studies have found that these algorithms provide better performance on average across 
targets than RF.

- An important result is that restricting to the most reliable RF predictions provides much greater predictive accuracy than that 
introduced by a more suitable learning algorithm (e.g., XGBoost).


Estimating the reliability of Drug synergy Predictions:

They applied a RF-specific reliability prediction approach, where the degree of agreement between the diverse trees 
in the forest serves as a reliability score. This is quantified here as the standard deviation (SD) of the RF tree predictions 
tree_SD has been pointed out as one of the most powerful metrics to assess the reliability of predictions in regression problems.

They then assemble test subsets with the 25% most reliable ComboScore predictions per cell line 
(i.e., combinations with the 25% lowest tree_SD scores).


In other paper, as baseline models, they ran 5 models. 
MEDIAN POLISH:
make a new prediction based on the median of the two
drugs and the cell line involved in the combination. The synergy
score is estimated by averaging over the medians of the two drugs
and the cell line median.

Elastic nets:
Is a penalized linear regression model that includes both the L1 and L2 penalties during training. 
performs variable selection and regularization simultaneously. 
The elastic net technique is most appropriate where the dimensional data is greater than the number of samples used.


SVM:  The algorithm creates a line or a hyperplane which separates the data into classes
We use a modified version of the
MinMax kernel to handle three types of features, binary, counts
and continuous ones, simultaneously. This kernel outperformed the
RBF kernel


RF: It builds decision trees on different samples and takes their majority vote for classification and average in case of regression.
The random forest algorithm is actually a bagging algorithm, 
 that fits multiple trees on different subsets of a training dataset, then combines the predictions from all trees.

GB: GBM is a composite model that combines the efforts of multiple weak models to create a strong model, 
and each additional weak model reduces the mean squared error (MSE) of the overall model. 
It's a boosting algorithm, and the main difference between RF and GB 
is that the random forest can able to build each tree independently 
on the other hand gradient boosting can build one tree at a time and each decision tree is built one after another.

These were the baseline models.
They further developed a deep synergy tool - it is a feed forward neural network, which maps input
vectors representing samples to a single output value, the synergy score.  

architecture:
For data normalization we employed three different types of input
normalization: (i) standardizing all inputs to zero mean and unit variance,
(ii) standarizing and applying hyperbolic tangent and (iii) standardizing,
hyperbolic tangent and standardizing again.

The hidden layers apply rectified linear activations and
the output layer used a linear activation. The mean squared error was
the objective function which was minimized.

The three hidden layers had 2000, 4000 and 8000 neurons in the first hidden
layer. They used stochastic gradient
descent with learning rates 10-4 and 10-5
and early-stopping and dropout as regularization techniques. 
For early-stopping, the adequate number of training iterations was determined
by a moving average over 25 epochs on a validation set. 
For dropout, either a dropout rate of 0.2 and 0.5 for the input
and the hidden layers, respectively, or no dropout at all. The best
hyperparameters were determined using grid search.

DeepSynergy is able to provide best predictions in a cross-validation setting
with external test sets, outperforming other methods by a wide
margin. Prioritizing drug combinations on the basis of the predictions
of DeepSynergy at an AUC of 0.90. Correlation coefficients for the set of drugs analyzed range from
0.57 to 0.84.

DeepSynergy achieved a test MSE of 255, while Gradient
Boosting Machines and Random Forests attained only inferior performance
of 275 and 308, respectively. Support Vector Machines
and Elastic Nets performed similar with MSEs of 398 and 420,
respectively, while median polish, which was used as a baseline,
achieved the worst result with an MSE of 478. 

A Wilcoxon signed rank-sum test was used to determine if the differences
in the mean squared errors are significant and all the P-values
are below 0.05. Hence, DeepSynergy outperforms the other machine
learning methods significantly with regard to MSE, RMSE and
Pearson correlation.

(After converting continuous values to binary values based by thresholding, for better interpretability of scores).


LIMITATIONS:
1. Although they mentioned that with respect to predictive performance, both increased dataset size and
algorithmic advances could further improve DeepSynergy performance. 


2. Even if training set size, features and classifier are the same, the modeled relationship between drug synergy and features 
depend on training set composition and cell line properties (implicitly). LODO cross-validation also revealed both best and worst partner
drugs. These differences are mainly due to the number of similar partner drugs. 
For example, it is difficult to predict synergy of combinations containing arsenic trioxide because its 103 partner drugs 
are highly dissimilar in terms of chemical structure and physico-chemical properties. 
Indeed, machine learning from dissimilar data instances tend to be less accurate. On the other hand, combinations containing
some other drugs are better represented in NCI-ALMANAC and hence tend to be predicted with higher accuracy. 
This is the case of various alkylating agents.

3. No confusion matrix for every cancer type.



IDEAS:
1. GCN based approach -  graph inputs
2. Add tocxicity, solubioity, etc. using https://proceedings.neurips.cc/paper/2015/file/f9be311e65d81a9ad8150a60844bb94c-Paper.pdf


However, drug combination effects can be adverse
and even lead to shorter progression free survival of cancer patients
(Hecht et al., 2009; Tol et al., 2009). Therefore, finding synergistic
drug pairs for a particular cancer type is important for improving
efficacy of anticancer treatment.











